<!--Filename: index.html-->
<!--Description: this HTML file serves as the index of the webpage and our UI-->
<!--Authors: Kevin Lopez-->
<!--cwid: 889508465-->
<!--email: kevinlopez8554@csu.fullerton.edu-->

<!--Emiliano Arranaga-->
<!--email: earranaga1202@csu.fullerton.edu-->
<!--cwid: 888006756-->

<!doctype html>
<html lang="en">
<head>
    <title>Project 1</title>

    <link href="../files/styles.css" rel="stylesheet">


</head>

<body>

<!--<script>-->
<!--    // Box width-->
<!--    var bw = 400;-->
<!--    // Box height-->
<!--    var bh = 400;-->
<!--    // Padding-->
<!--    var p = 10;-->

<!--    var canvas = document.getElementById("canvas");-->
<!--    var context = canvas.getContext("2d");-->
<!--    function drawBoard(){-->
<!--        for (var x = 0; x <= bw; x += 40) {-->
<!--            context.moveTo(0.5 + x + p, p);-->
<!--            context.lineTo(0.5 + x + p, bh + p);-->
<!--        }-->

<!--        for (var x = 0; x <= bh; x += 40) {-->
<!--            context.moveTo(p, 0.5 + x + p);-->
<!--            context.lineTo(bw + p, 0.5 + x + p);-->
<!--        }-->
<!--        context.strokeStyle = "white";-->
<!--        context.stroke();-->
<!--    }-->

<!--    drawBoard();-->
<!--</script>-->
<h1>Project 2</h1>

<div class="row" id="columnContainer">
    <div class="column" id="diveOne">
        <canvas class="canvasItem" id="first"></canvas>
    </div>
    <div class="column" id="diveTwo">
        <canvas class="canvasItem" id="second"></canvas>
    </div>
    <div class="column" id="diveThree">
        <canvas class="canvasItem" id="third"></canvas>
    </div>
    <div class="column" id="diveFour">
        <canvas class="canvasItem" id="fourth"></canvas>
    </div>
</div>


</body>


<!--<script src="../files/animator.js"></script>-->


<script>

    var isMergeSortFinished = false;
    var isGoldSortFinished = false;
    var allFunctionsFinished = false;
    var colOneList = [];
    var colTwoList = [];
    var colThreeList = [];
    var colFourList = [];
    var goldsArray = [];
    var mergeArray = [];


    let canvasOne = document.getElementById("first");
    var parent = document.getElementById("diveOne");
    canvasOne.width = parent.offsetWidth;
    canvasOne.height = parent.offsetHeight;
    let contx1 = canvasOne.getContext("2d");

    let canvasTwo = document.getElementById("second");
    var parentTwo = document.getElementById("diveTwo");
    canvasTwo.width = parentTwo.offsetWidth;
    canvasTwo.height = parentTwo.offsetHeight;
    let contx2 = canvasTwo.getContext("2d");

    let canvasThree = document.getElementById("third");
    var parentThree = document.getElementById("diveThree");
    canvasThree.width = parentThree.offsetWidth;
    canvasThree.height = parentThree.offsetHeight;
    let contx3 = canvasThree.getContext("2d");

    let canvasFour = document.getElementById("fourth");
    var parentFour = document.getElementById("diveFour");
    canvasFour.width = parentFour.offsetWidth;
    canvasFour.height = parentFour.offsetHeight;
    let contx4 = canvasFour.getContext("2d");

    draw_grid(contx1, 1, 42, 'white', "MergeSort");
    draw_grid(contx2, 1, 42, 'white', "Insertion Sort");
    draw_grid(contx3, 1, 42, 'white', "Gold Sort");
    draw_grid(contx4, 1, 42, 'white', "QuickSort");


    //canvas 1
    contx1.font = '15px Arial';
    contx1.fillStyle = "white";
    contx1.textAlign = "center";
    contx1.textBaseline = "middle";
    let nWidth = contx1.canvas.width / 2;
    var count = 0;


    contx3.font = '15px Arial';
    contx3.fillStyle = "white";
    contx3.textAlign = "center";
    contx3.textBaseline = "middle";

    var heightIncrement = contx1.canvas.height / 42;
    var yvalue = 10;


    var myArray = [5, 'F', 7, 'D', 8, 'A', 1, 5, 9, 3, 'B', 4, 7, 'B', 8];
    var originalArray = [5, 6, 4, 3, 10, 8, 1, 12, 14, 7, 20, 13, 25];
    // colOneList[0] = myArray.toString();
    // colTwoList[0] = myArray.toString();
    colThreeList[0] = [5, 6, 4, 3, 10, 8, 1, 12, 14, 7, 20, 13, 25].toString();
    colFourList[0] = [5, 6, 4, 3, 10, 8, 1, 12, 14, 7, 20, 13, 25].toString();



    insertionSort([5, 6, 4, 3, 10, 8, 1, 12, 14, 7, 20, 13, 25]);
    quickSort([5, 6, 4, 3, 10, 8, 1, 12, 14, 7, 20, 13, 25]);
    convertToDecimal(myArray);
    // mergeSort(myArray);
    // evenOddSort(myArray);
    runAllFunctions(); // function that starts the program!

    async function printLine(){
       // await sleep(5000);
        console.log("function printlnie()"); //the logs are just for me
        yvalue+=heightIncrement;
        console.log("y value"+ yvalue);
        console.log("nwidth: "+ nWidth);
        console.log(colOneList.toString());
        // console.log(colTwoList.toString());
        contx1.fillText(colOneList.toString(), nWidth, yvalue);
        // contx3.fillText(colTwoList.toString(), nWidth, yvalue);


    }



    async function runAllFunctions(){
        mergeSort(myArray); //run them once to start
        evenOddSort(myArray);
        for(var c = 0; c < 46; c++){
            console.log("sleeping");
            await sleep(500); //make it wait half a second

            // this conditional will have to include the other 2 algorithms too, but the same concept applies

            if(isMergeSortFinished && isGoldSortFinished){
                //if theyre done we can print the first line
                printLine(); //prints
                mergeSort(mergeArray); //continues to the next step
                evenOddSort(goldsArray);
            }
        }
    }



    function convertBackToHex(arrayToConvert) {
        for (var item in arrayToConvert) {
            hexValue = arrayToConvert[item].toString(16);
            arrayToConvert[item] = hexValue;
        }
    }

    function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }

    async function printLists() {
        var heightIncrement = contx1.canvas.height / 42;
        var yvalue = 10;
        for (var x = 0; x < 42; x++) {
            yvalue += heightIncrement;
            if (colOneList[x] != null) {
                contx1.fillText(colOneList[x], nWidth, yvalue);
            }
            if (colTwoList[x] != null) {
                contx3.fillText(colTwoList[x], nWidth, yvalue);
            }
            if (colThreeList[x] != null) {
                contx2.fillText(colThreeList[x], nWidth, yvalue);
            }
            if (colFourList[x] != null) {
                contx4.fillText(colFourList[x], nWidth, yvalue);
            }
            await sleep(500);
        }

    }

    //draws a grid
    function draw_grid(ctxz, min, maj, stroke_, name) {
        let width = ctxz.canvas.width;
        let height = ctxz.canvas.height;


        let textX = width / 2;
        let texty = height / 2;
        let n = name;

        // var width = canvasOne.getAttribute('width');
        // var height = canvasOne.getAttribute('height');

        for (let ix = 0; ix < width; ix += width / min) {
            ctxz.beginPath();
            ctxz.moveTo(ix, 0);
            ctxz.lineTo(ix, height);
            ctxz.strokeStyle = stroke_;
            ctxz.lineWidth = 2;
            ctxz.stroke();
        }
        for (let iy = 0; iy < height; iy += height / maj) {
            ctxz.beginPath();
            ctxz.moveTo(0, iy);
            ctxz.lineTo(width, iy);
            ctxz.strokeStyle = stroke_;
            ctxz.lineWidth = 2;
            ctxz.stroke();
        }

        ctxz.font = '15px Arial';
        ctxz.fillStyle = "white";
        ctxz.textAlign = "center";
        ctxz.textBaseline = "middle";
        ctxz.fillText(name, textX, 10);

    }


    function convertToDecimal(ArrToDecimal) {
        for (var index in ArrToDecimal) {
            var newNumber = parseInt(ArrToDecimal[index].toString(), 16);
            ArrToDecimal[index] = newNumber;
        }
    }





    function ringAround(arr, reverse) {
        if (reverse) arr.unshift(arr.pop());
        else arr.push(arr.shift());
        return arr;

    }

    // console.log(myArray);
    // console.log(ringAround(myArray, true));
    // console.log(mergeSort(myArray));

    function mergeSort(unsortedArray) {
        console.log("running mergesort");
        // No need to sort the array if the array only has one element or empty
        if (unsortedArray.length <= 1) {
            console.log("finished!");
            return unsortedArray;
        }else{
            console.log("not finished yet!");
        }


        // In order to divide the array in half, we need to figure out the middle
        const middle = Math.floor(unsortedArray.length / 2);

        // This is where we will be dividing the array into left and right
        const left = unsortedArray.slice(0, middle);
        const right = unsortedArray.slice(middle);


        // Using recursion to combine the left and right
        //this is where we have to pause

        //this used to be like
        // return merge(mergsort(left), mergesort(right));
              merge(
                left, right
            );

    }

    // Merge the two arrays: left and right
    function merge(left, right) {
        let resultArray = [], leftIndex = 0, rightIndex = 0;

        // We will add values into the resultArray in order
        while (leftIndex < left.length && rightIndex < right.length) {
            if (left[leftIndex] < right[rightIndex]) {
                resultArray.push(left[leftIndex]);
                leftIndex++; // move left array cursor
            } else {
                resultArray.push(right[rightIndex]);
                rightIndex++; // move right array cursor
            }
        }

        var printArray = resultArray.concat(left.slice(leftIndex)).concat(right.slice(rightIndex));
        convertBackToHex(printArray);
        colOneList.push(printArray.toString());

        //Before we move to the next step, wait for the other programs

        isMergeSortFinished = true;
        mergeArray = resultArray
            .concat(left.slice(leftIndex))
            .concat(right.slice(rightIndex));
        colOneList = mergeArray; //i changed the code so that colOneList now gets set to the array after the last
        //modification

    }


    //also i think this function is hella wrong so i need to watch videos to fix it
    function evenOddSort(inputArray) {
        console.log("running goldsort");
        var count3 = 0;
        var evens = [];
        var odds = [];
        var result = [];
        for (var i in inputArray) {
            if (inputArray[i] % 2 == 0) {
                evens.push(inputArray[i]);
            } else {
                odds.push(inputArray[i]);
            }
            convertBackToHex(evens);
            convertBackToHex(odds);
            // colTwoList.push((evens + "  ".repeat(6) + odds).toString());
            // goldsArray = evens + odds;
            isGoldSortFinished = true;
            //I removed the code i had here cause it broke my program when i had it and idont know how to fix it lmaoooooo
            // colTwoList = goldsArray;
            convertToDecimal(evens);
            convertToDecimal(odds);
        }
    }


    function insertionSort(insertionArray) {
        for (let i = 1; i < insertionArray.length; i++) {

            for (let j = i; j > 0; j--) {
                if (insertionArray[j] < insertionArray[j - 1]) {
                    const temp = insertionArray[j];
                    insertionArray[j] = insertionArray[j - 1];
                    insertionArray[j - 1] = temp;
                } else
                    break;

                colThreeList.push((insertionArray).toString());

            }

        }

    }

    function quickSort(quickArray) {
        if (quickArray.length <= 1) {
            return quickArray;
        }

        const pivot = quickArray[quickArray.length - 1];
        const left = [];
        const right = [];

        for (let i = 0; i < quickArray.length - 1; i++) {
            if (quickArray[i] < pivot) {
                left.push(quickArray[i])
            } else {
                right.push(quickArray[i]);
            }

        }

        if (left.length > 0 && right.length > 0) {
            return [...quickSort(left), pivot, ...quickSort(right)];
        } else if (left.length > 0) {
            return [...quickSort(left), pivot];
        } else {
            return [pivot, ...quickSort(right)];

        }

    }

</script>
</html>
